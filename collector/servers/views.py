from django.http import HttpResponse
from django.utils import simplejson
from collector.graphsConfig import fetchGraphConfig

# Create your views here.
def IndexView(request):
	return HttpResponse('Fecthing...')

def ServerDataFetchView(request, server_id, action):
	from collector import settings
	XS_SHARING_ALLOWED_ORIGINS = getattr(settings, "XS_SHARING_ALLOWED_ORIGINS", '')
	XS_SHARING_ALLOWED_METHODS = getattr(settings, "XS_SHARING_ALLOWED_METHODS", ['POST', 'GET', 'OPTIONS', 'PUT', 'DELETE'])
	XS_SHARING_ALLOWED_HEADERS = getattr(settings, "XS_SHARING_ALLOWED_HEADERS", [])
	print action
	series = []
	if action == 'cpu':
		data = gendata(40)
		series.append({'name':'System','color':'GoldenRod', 'data':data})
		data = gendata(30)
		series.append({'name':'User','color':'OliveDrab', 'data':data})
		data = gendata(35)
		series.append({'name':'WaitIO', 'color':'brown','data':data})
	elif action == 'memory':
		data = gendata(83)
		series.append({'name':'Used','color':'CadetBlue', 'data':data})
		data = gendata(78)
		series.append({'name':'Swapd','color':'DarkGray',  'data':data})
	elif action == 'disks':
		data = gendata(100)
		series.append({'name':'sda1','color': 'Teal',  'data':data})
		data = gendata(90)
		series.append({'name':'sda2','color': 'SaddleBrown',  'data':data})
	elif action == 'network':
		network = fetchGraphConfig('network')
		network.recvied['data'] = gendata(867)
		network.transmited['data'] = gendata(700)
		series = network.toSeries()

	else:
		data = gendata(11)
		series.append({'name':'Load one','color':'#008B8B',  'data':data})


	response_data = {'series': series}

	response = HttpResponse(simplejson.dumps(response_data,  ensure_ascii=False))

	response['Access-Control-Allow-Origin']  = XS_SHARING_ALLOWED_ORIGINS
	response['Access-Control-Allow-Methods'] = ",".join(XS_SHARING_ALLOWED_METHODS)
	response['Access-Control-Allow-Headers'] = ",".join(XS_SHARING_ALLOWED_HEADERS)
	return response
def gendata(rmax=70):
	import random
	i = 0
	count = 10
	time = 1387210289
	data = []
	while i<10:
		rand = random.randrange(rmax)
		time +=  500
		data.append([time, rand])
		print time, rand
		i+=1

	return data
	return [
			[1387001219, 28.52843137254901960784],
			[1387001220, 19.27352941176470588235],
			[1387001221, 20.74705882352941176470],
			[1387001491, 3.13823529411764705882],
			[1387001492, 24.69117647058823529411],
			[1387001494, 8.41176470588235294117],
			[1387001513, 26.26666666666666666666],
			[1387001514, 11.31960784313725490196],
			[1387001515, 11.36176470588235294117],
			[1387001521, 31.41274509803921568627],
			[1387001528, 16.03431372549019607843],
			[1387001821, 12.37254901960784313725],
			[1387002289, 16.99313725490196078431],
			[1387003187, 29.75490196078431372549],
			[1387004035, 6.52843137254901960784],
			[1387004158, 28.56274509803921568627],
			[1387004159, 7.04019607843137254901],
			[1387004162, 19.64607843137254901960],
			[1387004166, 9.34901960784313725490],
			[1387004204, 19.66470588235294117647],
			[1387004820, 12.41568627450980392156],
			[1387005421, 17.70980392156862745098],
			[1387005641, 12.38039215686274509803],
			[1387006471, 20.99215686274509803921],
			[1387007269, 17.67156862745098039215],
			[1387008087, 14.16274509803921568627],
			[1387008782, 2.31764705882352941176],
			[1387009021, 12.21078431372549019607],
			[1387009605, .25490196078431372549],
			[1387010463, 1.94411764705882352941],
			[1387011352, 2.99215686274509803921],
			[1387012171, 8.23235294117647058823],
			[1387012621, 28.05784313725490196078],
			[1387012929, 13.16960784313725490196],
			[1387013622, 30.08725490196078431372],
			[1387014395, 29.62058823529411764705],
			[1387015202, 8.48431372549019607843],
			[1387016048, 19.92549019607843137254],
			[1387016221, 15.31176470588235294117],
			[1387016788, 4.18529411764705882352],
			[1387016936, 27.23823529411764705882],
			[1387016942, 8.29117647058823529411],
			[1387016989, 9.78235294117647058823],
			[1387017063, 18.89117647058823529411],
			[1387017621, 31.19803921568627450980],
			[1387018456, 23.28725490196078431372],
			[1387019155, 10.61274509803921568627],
			[1387019821, 22.74901960784313725490],
			[1387019933, 24.95882352941176470588],
			[1387020762, 14.92549019607843137254],
			[1387021631, 16.35098039215686274509],
			[1387022331, 6.83823529411764705882],
			[1387023144, 19.26470588235294117647],
			[1387023421, 29.74509803921568627450],
			[1387023840, 6.96176470588235294117],
			[1387024712, 28.79019607843137254901],
			[1387025606, 15.66176470588235294117],
			[1387026055, 14.04509803921568627450],
			[1387026089, 27.75588235294117647058],
			[1387026111, 28.72647058823529411764],
			[1387026113, 5.15784313725490196078],
			[1387026341, 30.36666666666666666666],
			[1387027022, 9.73039215686274509803],
			[1387027080, 26.21960784313725490196],
			[1387027265, 10.11666666666666666666],
			[1387027289, 31.95392156862745098039],
			[1387027972, 12.09019607843137254901],
			[1387028682, 30.70000000000000000000],
			[1387029564, 2.27549019607843137254],
			[1387030273, 22.81960784313725490196],
			[1387030621, 1.57254901960784313725],
			[1387031082, .40784313725490196078],
			[1387031457, 5.64803921568627450980],
			[1387031510, 14.91274509803921568627],
			[1387031789, 8.27450980392156862745],
			[1387032489, 21.75196078431372549019],
			[1387033223, 6.90980392156862745098],
			[1387034023, 15.91960784313725490196],
			[1387034221, 3.29901960784313725490],
			[1387034884, 31.97254901960784313725],
			[1387035735, 21.23235294117647058823],
			[1387036446, 26.20588235294117647058],
			[1387037309, 28.33823529411764705882],
			[1387037821, 6.59411764705882352941],
			[1387038061, 6.70196078431372549019],
			[1387038215, 18.02352941176470588235],
			[1387038227, 1.07941176470588235294],
			[1387038800, 32.04117647058823529411],
			[1387158299, 21.79803921568627450980],
			[1387158300, 9.71960784313725490196],
			[1387158301, 25.52941176470588235294],
			[1387158306, 7.65686274509803921568],
			[1387158312, 14.49019607843137254901],
			[1387158994, 21.17647058823529411764],
			[1387159799, 7.72647058823529411764],
			[1387160221, 22.41078431372549019607],
			[1387160545, 9.85588235294117647058],
			[1387161398, 31.84901960784313725490],
			[1387162169, 7.27549019607843137254],
			[1387162879, 3.88921568627450980392],
			[1387163650, 21.57843137254901960784],
			[1387163651, 17.40784313725490196078],
			[1387163821, 5.50588235294117647058],
			[1387164328, 14.73725490196078431372],
			[1387165047, 27.60686274509803921568],
			[1387165847, 4.58137254901960784313],
			[1387165903, 3.79411764705882352941],
			[1387166697, 4.50980392156862745098],
			[1387167421, 29.41960784313725490196],
			[1387167458, 29.68921568627450980392],
			[1387168223, 9.11274509803921568627],
			[1387168929, 9.08529411764705882352],
			[1387169702, 5.92647058823529411764],
			[1387170549, 6.80392156862745098039],
			[1387171021, 24.96764705882352941176],
			[1387171236, 2.95392156862745098039],
			[1387171988, 26.72254901960784313725],
			[1387172742, 28.40882352941176470588],
			[1386023101, 25.13921568627450980392],
			[1386023928, 9.37450980392156862745],
			[1386024813, 13.54901960784313725490],
			[1386025640, 9.11764705882352941176],
			[1386026221, 16.90588235294117647058],
			[1386026460, 31.05392156862745098039],
			[1386027356, 16.37352941176470588235],
			[1386028131, 30.52156862745098039215],
			[1386028805, 27.25196078431372549019],
			[1386028885, 5.93627450980392156862],
			[1386028963, 10.35294117647058823529],
			[1386029807, 28.92352941176470588235],
			[1386029821, 9.17647058823529411764],
			[1386030639, 6.71568627450980392156],
			[1386031439, 27.49901960784313725490],
			[1386032166, 27.54705882352941176470],
			[1386032886, 5.51274509803921568627],
			[1386033421, 21.92745098039215686274],
			[1386033691, 25.90196078431372549019],
			[1386034504, 15.70098039215686274509],
			[1386035403, 13.48235294117647058823],
			[1386036125, 13.64117647058823529411],
			[1386036880, 3.21862745098039215686],
			[1386037021, 4.92549019607843137254],
			[1386037579, 20.62156862745098039215],
			[1386038288, 30.49117647058823529411],
			[1386039114, 7.31568627450980392156],
			[1386039805, 19.91568627450980392156],
			[1386040551, 29.78529411764705882352],
			[1386040621, 26.29313725490196078431],
			[1386041418, 11.85784313725490196078],
			[1386042196, 25.93137254901960784313],
			[1386042974, 18.95784313725490196078],
			[1386043774, 31.81274509803921568627],
			[1386044221, 31.80686274509803921568],
			[1386044653, 4.31960784313725490196],
			[1386044654, 1.08333333333333333333],
			[1386045341, 16.94705882352941176470],
			[1386046217, 5.76960784313725490196],
			[1386047048, 13.70490196078431372549],
			[1386047739, 19.61274509803921568627],
			[1386047821, 1.80294117647058823529],
			[1386048558, 31.65196078431372549019],
			[1386049454, 3.42549019607843137254],
			[1386050164, 21.99607843137254901960],
			[1386051030, 20.93921568627450980392],
			[1386051421, 1.22549019607843137254],
			[1386051802, 2.27058823529411764705],
			[1386052494, 6.74117647058823529411],
			[1386053366, 31.04313725490196078431],
			[1386054228, 14.77843137254901960784],
			[1386055021, 24.72549019607843137254],
			[1386055065, 24.19901960784313725490],
			[1386055767, 8.87450980392156862745],
			[1386056508, 30.43333333333333333333],
			[1386057253, 5.04509803921568627450],
			[1386057998, 19.83725490196078431372],
			[1386058621, 20.76862745098039215686],
			[1386058858, 25.73921568627450980392],
			[1386059651, .05490196078431372549],
			[1386060388, 20.89215686274509803921],
			[1386061177, 4.29803921568627450980],
			[1386061886, 6.75686274509803921568],
			[1386062221, 20.79411764705882352941],
			[1386062699, 26.86960784313725490196],
			[1386063476, 19.26764705882352941176],
			[1386063543, 23.62843137254901960784],
			[1386063548, 21.07745098039215686274],
			[1386063558, 15.65196078431372549019],
			[1386063578, 27.95588235294117647058],
			[1386063586, 1.01960784313725490196],
			[1386063600, 20.64117647058823529411],
			[1386063617, 25.59117647058823529411],
			[1386063633, 31.60980392156862745098],
			[1386063640, 7.44019607843137254901],
			[1386063653, 9.45882352941176470588],
			[1386063656, 18.84803921568627450980],
			[1386063664, 26.58235294117647058823],
			[1386064390, 19.55196078431372549019],
			[1386065240, 30.03235294117647058823],
			[1386065821, 24.71764705882352941176],
			[1386065991, 6.01862745098039215686],
			[1386066873, 22.41274509803921568627],
			[1386067700, 20.69411764705882352941],
			[1386068447, 3.93235294117647058823],
			[1386069290, 20.32647058823529411764],
			[1386069421, 8.37352941176470588235],
			[1386070082, 9.36176470588235294117],
			[1386070979, 30.62450980392156862745],
			[1386071655, 3.90980392156862745098],
			[1386072537, 23.75294117647058823529],
			[1386073021, 6.93333333333333333333],
			[1386073238, 26.31274509803921568627],
			[1386074128, 30.61862745098039215686],
			[1386074853, 17.01274509803921568627],
			[1386075565, 29.64607843137254901960],
			[1386076443, 29.52647058823529411764],
			[1386076621, 29.46666666666666666666],
			[1386077134, 7.32156862745098039215],
			[1386077907, 8.52843137254901960784],
			[1386078727, 29.91960784313725490196],
			[1386079464, 21.43431372549019607843],
			[1386080141, 20.65294117647058823529],
			[1386080221, 5.88235294117647058823],
			[1386080904, 12.56274509803921568627],
			[1386081671, 18.39607843137254901960],
			[1386082455, 17.39607843137254901960],
			[1386083346, 27.17549019607843137254],
			[1386083821, 28.97254901960784313725],
			[1386084121, 20.72352941176470588235],
			[1386084888, 11.64803921568627450980],
			[1386085707, 28.17352941176470588235],
			[1386085708, 18.74803921568627450980],
			[1386086569, 13.10098039215686274509],
			[1386087354, 4.85490196078431372549],
			[1386087421, 8.41960784313725490196],
			[1386088075, 26.38235294117647058823],
			[1386088949, 4.20392156862745098039],
			[1386089725, 31.92254901960784313725],
			[1386090577, 23.71862745098039215686],
			[1386091021, 26.75784313725490196078],
			[1386091355, 7.38529411764705882352],
			[1386092056, 31.68333333333333333333],
			[1386092899, 27.20098039215686274509],
			[1386093703, 17.73627450980392156862],
			[1386093891, 15.66176470588235294117],
			[1386093923, 27.15980392156862745098],
			[1386094490, 16.09313725490196078431],
			[1386094621, 24.41176470588235294117], ]
